---
import Layout from '../../layouts/Layout.astro';
import { sanityClient } from 'sanity:client';
import { getFeaturedPostsByLanguage } from '../../lib/sanity-queries';
import { t, formatDate } from '../../lib/i18n';

// Récupérer les articles mis en avant en anglais
const featuredPosts = await sanityClient.fetch(getFeaturedPostsByLanguage('en'));
---

<Layout title="ChronoLoot - English" description="Discover our latest articles and news">
  <main class="container mx-auto px-4 py-8">
    <!-- Hero Section -->
    <section class="text-center py-16">
      <h1 class="text-5xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
        Welcome to ChronoLoot
      </h1>
      <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
        Discover the latest articles, insights, and stories from our community.
      </p>
      <div class="flex gap-4 justify-center">
        <a href="/en/blog" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors">
          Explore Blog
        </a>
        <a href="/blog" class="border border-gray-300 text-gray-700 px-8 py-3 rounded-lg font-medium hover:bg-gray-50 transition-colors">
          Version Française
        </a>
      </div>
    </section>

    <!-- Featured Posts -->
    {featuredPosts.length > 0 && (
      <section class="py-16">
        <h2 class="text-3xl font-bold mb-8 text-center">Featured Articles</h2>
        <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
          {featuredPosts.map((post: any) => (
            <article class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
              {post.mainImage && (
                <img 
                  src={post.mainImage.asset.url} 
                  alt={post.mainImage.alt || post.title}
                  class="w-full h-48 object-cover"
                />
              )}
              
              <div class="p-6">
                <div class="flex flex-wrap gap-2 mb-3">
                  {post.categories?.map((category: any) => (
                    <span 
                      class="px-2 py-1 text-xs rounded-full text-white"
                      style={`background-color: ${category.color || '#3B82F6'}`}
                    >
                      {category.title}
                    </span>
                  ))}
                </div>
                
                <h3 class="text-xl font-semibold mb-2">
                  <a 
                    href={`/en/blog/${post.slug.current}`}
                    class="hover:text-blue-600 transition-colors"
                  >
                    {post.title}
                  </a>
                </h3>
                
                {post.excerpt && (
                  <p class="text-gray-600 mb-4">{post.excerpt}</p>
                )}
                
                <div class="flex items-center justify-between text-sm text-gray-500">
                  <div class="flex items-center gap-2">
                    {post.author?.image && (
                      <img 
                        src={post.author.image.asset.url} 
                        alt={post.author.name}
                        class="w-6 h-6 rounded-full"
                      />
                    )}
                    <span>{t('blog.by', 'en')} {post.author?.name}</span>
                  </div>
                  
                  <div class="flex items-center gap-4">
                    {post.readingTime && (
                      <span>{post.readingTime} {t('blog.readingTime', 'en')}</span>
                    )}
                    <time dateTime={post.publishedAt}>
                      {formatDate(post.publishedAt, 'en')}
                    </time>
                  </div>
                </div>
                
                <a 
                  href={`/en/blog/${post.slug.current}`}
                  class="inline-block mt-4 text-blue-600 hover:text-blue-800 font-medium"
                >
                  {t('blog.readMore', 'en')} →
                </a>
              </div>
            </article>
          ))}
        </div>
        
        <div class="text-center mt-8">
          <a href="/en/blog" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors">
            View All Articles
          </a>
        </div>
      </section>
    )}
  </main>
</Layout>

<style>
  .container {
    max-width: 1200px;
  }
</style>
